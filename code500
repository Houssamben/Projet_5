
return {
    "statusCode": 500,
    "headers": {"Content-Type": "application/json"},
    "body": {"error": "Internal error"}
}


from dataiku.apinode.exceptions import DkuCustomApiException


   "from dataiku.apinode.exceptions import DkuCustomApiException",
    "from dataiku.apinode import DkuCustomApiException",
    "from dataiku.apinode.utils import DkuCustomApiException",
    "from dataiku.apinode.utils.exceptions import DkuCustomApiException",
    "from dataiku.apinode.predict.exceptions import DkuCustomApiException",
    "from dataiku.apinode.predict import DkuCustomApiException",
    "from dataiku.exceptions import DkuCustomApiException",
    "from dataiku import DkuCustomApiException",
    "from dataiku.customwebapp import DkuCustomApiException"


dataiku.apinode.exceptions


"from dataiku.apinode.exceptions import DkuCustomApiException",
    "from dataiku.apinode import DkuCustomApiException",
    "from dataiku.apinode.utils import DkuCustomApiException",
    "from dataiku.apinode.utils.exceptions import DkuCustomApiException",

    # prediction‑related modules (sometimes available even for python endpoints)
    "from dataiku.apinode.predict.exceptions import DkuCustomApiException",
    "from dataiku.apinode.predict import DkuCustomApiException",

    # generic fallback locations
    'from dataiku.exceptions import DkuCustomApiException',
    'from dataiku import DkuCustomApiException',

    # webapp version (unlikely for API Node, but included to test everything)
    "from dataiku.customwebapp import DkuCustomApiException",
]

from dataiku.apinode.predict.predictor import RegressionPredictor
import pandas as pd

class MyPredictor(RegressionPredictor):

    def predict(self, features_df: pd.DataFrame):

        # Test très simple : si aucun header d'auth existe → erreur contrôlée
        http_headers = dku_http_request_metadata.headers

        if not http_headers.get("Authorization"):
            raise DkuCustomApiException(
                "No Authorization header provided",
                http_status_code=401
            )

        # Retourne toujours une prédiction fixe (ex : 42)
        # Longueur = nombre de lignes dans features_df
        return pd.Series([42] * len(features_df))

